\documentclass[12pt,oneside,a4paper]{article}

\usepackage[utf8]{inputenc} % Lærer LaTeX at forstå unicode - HUSK at filen skal
% være unicode (UTF-8), standard i Linux, ikke i
% Win.

\usepackage[danish]{babel} % Så der fx står Figur og ikke Figure, Resumé og ikke
% Abstract etc. (god at have).

%\usepackage{graphicx}
%\usepackage{amsfonts}
%\usepackage{esvect}

%\renewcommand{\mid}[1]{{\rm E}\!\left[#1\right]}
\newcommand{\bas}{\begin{eqnarray*}}
\newcommand{\eas}{\end{eqnarray*}}
\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}

\usepackage{amsthm}        % Theorems
\newtheorem{thm}{Sætning}[section]
\newtheorem{lem}{Lemma}[section]
\newtheorem{mydef}[thm]{Definition}
\newtheorem{eks}[thm]{Eksempel}

\begin{document}

\section*{Opgave}
Bestem samtlige heltallige løsninger til
\be
(a^2-1)(b^2-1) = c^2,
\label{eq1}
\ee
hvor $1\le a\le b$ og $c\ge 0$.

\section*{Løsning}
Ligningen har trivielle løsninger af formen $(1, b, 0)$ for vilkårlig
heltallig $b\ge 1$. I det følgende antager vi derfor, at $a>1$ og $c>0$.

Vi definerer først den lineære afbildning
\bas
\tilde b &=& ab-c \\
\tilde c &=& (1-a^2)b+ac
\eas
Vi viser nogle lemmaer, inden vi fuldfører løsningen.

\begin{lem}
    Hvis $(a,b,c)$ er en løsning til~(\ref{eq1}), så er også $(a,\tilde b,
    \tilde c)$ en løsning.
\end{lem}
\begin{proof}
    Vi udregner
    \bas
    && (a^2-1)({\tilde b}^2-1) - {\tilde c}^2 \\
    &=& (a^2-1)\left(a^2b^2 + c^2 - 2abc - 1\right) - (1-a^2)^2b^2-a^2c^2-2a(1-a^2)bc \\
    &=& (a^2-1)\left(a^2b^2 + c^2 - 2abc - 1 - (a^2-1)b^2 + 2abc\right) - a^2c^2 \\
    &=& (a^2-1)(b^2 + c^2 - 1) - a^2c^2 \\
    &=& (a^2-1)(b^2-1) - c^2
    \eas
    Hermed er det ønskede vist.
\end{proof}

\begin{lem}
    Hvis $(a,b,c)$ er en løsning til~(\ref{eq1}), med $1<a\le b$ og $c>0$
    så gælder
    $$
    0 < \tilde b
    $$
\end{lem}
\begin{proof}
    Fra ligning~(\ref{eq1}) har vi umiddelbart, at $c<ab$. Heraf følger det ønskede.
\end{proof}

\begin{lem}
    Hvis $(a,b,c)$ er en løsning til~(\ref{eq1}), med $1<a\le b$ og $c>0$
    så gælder
    $$
    \tilde b < b
    $$
\end{lem}
\begin{proof}
    Dette føres som et modstridsbevis. Dvs antag at $\tilde b \ge b$. Det giver
    følgende kæde:
    \bas
    && \tilde b \ge b \\
    &\Rightarrow& ab-c \ge b \\
    &\Rightarrow& (a-1)b \ge c \\
    &\Rightarrow& (a-1)bc \ge c^2 = (a^2-1)(b^2-1) \\
    &\Rightarrow& bc \ge (a+1)(b^2-1)
    \eas
    
    Derudover finder vi:
    \bas
    && (a-1)b \ge c \\
    &\Rightarrow& (a-1)b^2 \ge bc \ge (a+1)(b^2-1) \\
    &\Rightarrow& ab^2-b^2 \ge ab^2+b^2-a-1 \\
    &\Rightarrow& a+1 \ge 2b^2 \ge 2a^2
    \eas
    Det sidste er en modstrid for $a>1$, og dermed er det ønskede vist.
\end{proof}

\begin{lem}
    Hvis $(a,b,c)$ er en løsning til~(\ref{eq1}), med $1<a\le b$ og $c>0$
    så gælder
    $$
    0 \le \tilde c
    $$
\end{lem}
\begin{proof}
    Dette føres også som et modstridsbevis. Dvs antag at $0 > \tilde c$. Det
    giver følgende kæde.
    \bas
    &&0 > \tilde c\\
    &\Rightarrow& 0 > (1-a^2)b+ac \\
    &\Rightarrow& (a^2-1)b > ac \\
    &\Rightarrow& (a^2-1)bc > ac^2 = a(a^2-1)(b^2-1) \\
    &\Rightarrow& bc > a(b^2-1) \\
    \eas
    
    Derudover finder vi:
    \bas
    && (a^2-1)b > ac \\
    &\Rightarrow& (a^2-1)b^2 > abc > a^2(b^2-1) \\
    &\Rightarrow& a^2 > b^2
    \eas
    Det sidste er en modstrid, og dermed er det ønskede vist.
\end{proof}

Vi har således vist, at fra enhver løsning $(a,b,c)$ med $1<a\le b$ og $c>0$
kan vi konstruere en ny løsning $(a, \tilde b, \tilde c)$ med $0<\tilde b < b$
og $0 \le \tilde c$. Ved eventuel ombytning af $a$ og $\tilde b$ kan vi
endvidere opnå, at $a\le\tilde b$. Processen kan dermed gentages indtil vi når
de trivielle løsninger af formen $(1, b, 0)$.
Afbildningen kan også inverteres, og dermed kan vi rekursivt generere samtlige
løsninger. I det følgende udledes en kompakt formel for samtlige løsninger.

Vi får brug for Chebyshev polynomierne af første art $T_n(x)$ og anden art
$U_n(x)$, defineret ved henholdsvis:
$$
T_n(\cos\theta) = \cos n\theta
$$
og
$$
U_n(\cos\theta) = \frac{\sin (n+1)\theta}{\sin\theta}
$$
De opfylder begge den samme rekursionsformel:
$$
T_{n+2}(x) = 2xT_{n+1}(x) - T_n(x)
$$
men med de forskellige begyndelsesbetingelser:
\bas
T_0(x) &=& 1 \\
T_1(x) &=& x \\
U_0(x) &=& 1 \\
U_1(x) &=& 2x
\eas
Specielt er de begge polynomier med heltallige koefficienter.
Disse polynomier opfylder bl.a. følgende indbyrdes relationer:
\bas
T_m^2(x) - 1 &=& (x^2-1)U_{m-1}^2(x) \\
T_{m+n}(x) - T_{|m-n|}(x) &=& 2(x^2-1)U_{m-1}(x)U_{n-1}(x) \\
T_m(x) T_n(x) &=& \frac12 \left(T_{m+n}(x) + T_{|m-n|}(x)\right),
\eas
som alle nemt vises ud fra definitionen.

Vi er nu klar til at give den fuldstændige løsning:
\begin{thm}
    Samtlige heltallige løsninger til ligning~(\ref{eq1}) er givet ved:
    \bas
    a &=& T_m(x) \\
    b &=& T_n(x) \\
    c &=& \frac 12 \left(T_{m+n}(x) - T_{|m-n|}(x)\right) 
    \eas
    hvor $x\ge 0$ er et vilkårligt heltal, og $m,n \ge 0$ er heltallige.
\end{thm}
\begin{proof}
    Først viser vi, at de givne værdier opfylder ligning~(\ref{eq1}). 
Lad nu $a=T_m(x)$ og $b = T_n(x)$. Da udregner vi 
\bas
(a^2-1)(b^2-1) &=& (T_m^2(x)-1)(T_n^2(x)-1) \\
                        &=& (x^2-1)^2 U_{m-1}^2(x) U_{n-1}^2(x) \\
                        &=& \left( (x^2-1) U_{m-1}(x) U_{n-1}(x)\right)^2
\eas
Endvidere er 
\bas
c &=& \frac 12 \left(T_{m+n}(x) - T_{|m-n|}(x)\right) \\
&=& (x^2-1) U_{m-1}(x) U_{n-1}(x) 
\eas
Hermed er det vist, at det vitterlig er en løsning.

Nu viser vi, at det også er samtlige løsninger. Vi udregner derfor
transformationen til $(a,\tilde b,\tilde c)$:
\bas
\tilde b &=& a b - c \\
  &=& T_m(x) T_n(x) - \frac 12 \left(T_{m+n}(x) - T_{|m-n|}(x)\right) \\
  &=& \frac12 \left(T_{m+n}(x) + T_{|m-n|}(x)\right) - \frac 12 \left(T_{m+n}(x) - T_{|m-n|}(x)\right) \\
  &=& T_{|m-n|}(x)
\eas
Således er $\tilde b$ skrevet på samme form som $b$. Dermed er det vist, at transformationen ikke genererer andre løsninger end de givne.

Vi har således vist det ønskede.

\end{proof}

\end{document}

